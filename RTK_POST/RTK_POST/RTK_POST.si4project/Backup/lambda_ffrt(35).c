/********************************************************************
* 版权所有（C）2021，广州汇天航空航天科技有限公司
* 
* 文件名称：func_lambda_ffrt.c
* 内容摘要：LAMBDA_FFRT_PAR算法(固定失败率的不完全模糊度解算)
* 其他说明：
* 版本  号：
* 作    者：sunbz
* 完成日期：2021-06-02
********************************************************************/
/*------------------------------------------------------------------------------
* lambda.c : integer ambiguity resolution
*
*          Copyright (C) 2007-2008 by T.TAKASU, All rights reserved.
*
* reference :
*     [1] P.J.G.Teunissen, The least-square ambiguity decorrelation adjustment:
*         a method for fast GPS ambiguity estimation, J.Geodesy, Vol.70, 65-82,
*         1995
*     [2] X.-W.Chang, X.Yang, T.Zhou, MLAMBDA: A modified LAMBDA method for
*         integer least-squares estimation, J.Geodesy, Vol.79, 552-565, 2005
*
* version : $Revision: 1.1 $ $Date: 2008/07/17 21:48:06 $
* history : 2007/01/13 1.0 new
*-----------------------------------------------------------------------------*/
#include "rtklib.h"
#include "RelPos.h"

/* constants/macros ----------------------------------------------------------*/
#define LOOPMAX     (10000)           /* maximum count of search loop */
#define SGN(x)      ((x)<=0.0?-1.0:1.0)
#define ROUND(x)    (floor((x)+0.5))
#define SWAP(x,y)   do {float64_t tmp_; tmp_=x; x=y; y=tmp_;} while (0)

/* LD factorization (Q=L*diag(D)*L') -----------------------------------------*/
static sint8_t LD(uint16_t n, const float64_t Q[], float64_t L[], float64_t D[])
{
	sint32_t i, j, k;
	sint8_t info=0;
	float64_t a,A[MAXDIM*MAXDIM];

	memcpy(A,Q,sizeof(float64_t)*n*n);
	for (i=n-1;i>=0;i--) 
	{
		if ((D[i]=A[i+i*n])<=0.0) 
		{
			info=-1;
			break;
		}
		a=sqrt(D[i]);
		for (j=0;j<=i;j++) L[i+j*n]=A[i+j*n]/a;
		for (j=0;j<=i-1;j++) for (k=0;k<=j;k++) A[j+k*n]-=L[i+k*n]*L[i+j*n];
		for (j=0;j<=i;j++) L[i+j*n]/=L[i+i*n];
	}
	return info;
}

/* integer gauss transformation ----------------------------------------------*/
static void gauss(uint16_t n, float64_t L[], float64_t Z[], sint32_t i, sint32_t j)
{
	sint32_t k, mu;

	if ((mu=(int)ROUND(L[i+j*n]))!=0) 
	{
		for (k=i;k<n;k++) L[k+n*j]-=(float64_t)mu*L[k+i*n];
		for (k=0;k<n;k++) Z[k+n*j]-=(float64_t)mu*Z[k+i*n];
	}
}

/* permutations --------------------------------------------------------------*/
static void perm(uint16_t n, float64_t L[], float64_t D[], sint32_t j, float64_t del, float64_t Z[])
{
	sint32_t k;
	float64_t eta,lam,a0,a1;

	eta=D[j]/del;
	lam=D[j+1]*L[j+1+j*n]/del;
	D[j]=eta*D[j+1]; D[j+1]=del;

	for (k=0;k<=j-1;k++) 
	{
		a0=L[j+k*n]; a1=L[j+1+k*n];
		L[j+k*n]=-L[j+1+j*n]*a0+a1;
		L[j+1+k*n]=eta*a0+lam*a1;
	}

	L[j+1+j*n]=lam;

	for (k=j+2;k<n;k++) SWAP(L[k+j*n],L[k+(j+1)*n]);
	for (k=0;k<n;k++) SWAP(Z[k+j*n],Z[k+(j+1)*n]);
}

//对协因数阵Q进行LtDL分解进行整数变换(变换后的新参数之间相关性显著减小)
/* lambda reduction (z=Z'*a, Qz=Z'*Q*Z=L'*diag(D)*L) (ref.[1]) ---------------*/
static void reduction(sint16_t n, float64_t L[], float64_t D[], float64_t Z[])
{
	sint32_t i, j, k;
	float64_t del;

	j=n-2; k=n-2;
	while (j>=0) 
	{
		if (j <= k)
		{
			for (i = j + 1; i < n; i++)
				gauss(n, L, Z, i, j);
		}

		del=D[j]+L[j+1+j*n]*L[j+1+j*n]*D[j+1];
		if (del+1E-6<D[j+1])//compared considering numerical error 
		{ 
			
			perm(n,L,D,j,del,Z);
			k=j; j=n-2;
		}
		else 
		{
			j--;
		}
	}
}

/* modified lambda (mlambda) search (ref. [2]) -------------------------------*/
static sint8_t search(uint16_t n, uint16_t m, const float64_t L[], const float64_t D[],
				  const float64_t zs[], float64_t zn[], float64_t s[])
{
	sint32_t i, j, k, c, nn = 0, imax = 0;
	float64_t newdist,maxdist=1E99,y;
	float64_t S[MAXDIM*MAXDIM];
	float64_t dist[MAXDIM],zb[MAXDIM],z[MAXDIM],step[MAXDIM];

	memset(&S[0],0,MAXDIM*MAXDIM*sizeof(float64_t));

	k=n-1; dist[k]=0.0;
	zb[k]=zs[k];
	z[k]=ROUND(zb[k]); y=zb[k]-z[k]; step[k]=SGN(y);

	for (c=0;c<LOOPMAX;c++) 
	{
		newdist=dist[k]+y*y/D[k];
		if (newdist<maxdist) 
		{
			if (k!=0) 
			{
				dist[--k]=newdist;
				for (i=0;i<=k;i++)
				{
					S[k+i*n]=S[k+1+i*n]+(z[k+1]-zb[k+1])*L[k+1+i*n];
				}
				zb[k]=zs[k]+S[k+k*n];
				z[k]=ROUND(zb[k]); y=zb[k]-z[k]; step[k]=SGN(y);
			}
			else 
			{
				if (nn<m) 
				{
					if (nn==0||newdist>s[imax]) imax=nn;
					for (i=0;i<n;i++) zn[i+nn*n]=z[i];
					s[nn++]=newdist;
				}
				else 
				{
					if (newdist<s[imax]) 
					{
						for (i=0;i<n;i++) zn[i+imax*n]=z[i];
						s[imax]=newdist;
						for (i=imax=0;i<m;i++) if (s[imax]<s[i]) imax=i;
					}
					maxdist=s[imax];
				}
				z[0]+=step[0]; y=zb[0]-z[0]; step[0]=-step[0]-SGN(step[0]);
			}
		}
		else 
		{
			if (k==n-1) break;
			else 
			{
				k++;
				z[k]+=step[k]; y=zb[k]-z[k]; step[k]=-step[k]-SGN(step[k]);
			}
		}
	}
	for (i=0;i<m-1;i++) // sort by s 
	{ 
		for (j=i+1;j<m;j++) 
		{
			if (s[i]<s[j]) continue;
			SWAP(s[i],s[j]);
			for (k=0;k<n;k++) SWAP(zn[k+i*n],zn[k+j*n]);
		}
	}

	if (c>=LOOPMAX) 
	{
		return -1;
	}
	return 0;
}

static float64_t interp1q(float64_t x[], float64_t y[], sint32_t dim, float64_t xi)
{
	sint32_t lowidx = 0, medidx, highidx = dim - 1;
	static float64_t t=0;

	if (xi<x[lowidx]||xi>x[highidx]) 
	{
		//exit(0);
		return 0.0;
	}
	else if(xi==x[lowidx]) 
	{
		return y[lowidx]>0.001 ? y[highidx]: 0.0001;
	}
	else if(xi==x[highidx])
	{
		return y[highidx]>0.001 ? y[highidx]: 0.0001;
	}
	else
	{
		while(lowidx<highidx-1)
		{
			medidx=(lowidx+highidx)/2;
			if(x[medidx]<xi)
			{
				lowidx=medidx;
			}
			else if(x[medidx]==xi)
			{
				return y[medidx]>0.001 ? y[highidx]: 0.0001;
			}
			else
			{
				highidx=medidx;
			}
		}

		t=(y[lowidx]+y[highidx])/2;

		return t>0.0001?t:0.0001;
	}
}

static float64_t invratio(float64_t Pf, float64_t PfILS, uint16_t n)
{
	static float64_t table1[1984]={0, 0.0010, 0.0012, 0.0015, 0.0020, 0.0050, 0.0100, 0.0150, 0.0200, 0.0250, 0.0300, 0.0350, 0.0400, 0.0450, 0.0500, 0.0550, 0.0600, 0.0650, 0.0700, 0.0750, 0.0800, 0.0850, 0.0900, 0.0950, 0.1000, 0.1200, 0.1500, 0.2000, 0.2500, 0.2600, 1,
		1, 1, 0.9400, 0.8700, 0.7800, 0.5400, 0.3600, 0.2700, 0.2100, 0.1900, 0.1700, 0.1600, 0.1500, 0.1400, 0.1300, 0.1200, 0.1200, 0.1100, 0.1100, 0.1000, 0.1000, 0.1000, 0.0900, 0.0900, 0.0900, 0.0800, 0.0700, 0.0500, 0.0400, 0, 0,
		1, 1, 0.9400, 0.8700, 0.7800, 0.5400, 0.3800, 0.2900, 0.2400, 0.2200, 0.2000, 0.1800, 0.1700, 0.1600, 0.1500, 0.1400, 0.1300, 0.1200, 0.1200, 0.1100, 0.1000, 0.1000, 0.0900, 0.0900, 0.0900, 0.0800, 0.0700, 0.0500, 0.0400, 0, 0,
		1, 1, 0.9400, 0.8800, 0.8000, 0.5700, 0.4100, 0.3200, 0.2700, 0.2400, 0.2200, 0.2000, 0.1800, 0.1700, 0.1600, 0.1500, 0.1500, 0.1400, 0.1300, 0.1200, 0.1200, 0.1100, 0.1100, 0.1000, 0.1000, 0.0900, 0.0800, 0.0600, 0.0500, 0, 0,
		1, 1, 0.9400, 0.8800, 0.8000, 0.5700, 0.4300, 0.3600, 0.3000, 0.2700, 0.2400, 0.2200, 0.2100, 0.1900, 0.1800, 0.1700, 0.1600, 0.1500, 0.1400, 0.1300, 0.1300, 0.1200, 0.1200, 0.1100, 0.1100, 0.0900, 0.0800, 0.0600, 0.0600, 0, 0,
		1, 1, 0.9400, 0.8900, 0.8100, 0.5900, 0.4500, 0.3800, 0.3300, 0.2900, 0.2600, 0.2400, 0.2200, 0.2100, 0.1900, 0.1800, 0.1700, 0.1600, 0.1500, 0.1500, 0.1400, 0.1400, 0.1300, 0.1300, 0.1200, 0.1100, 0.1000, 0.1000, 0.0900, 0, 0,
		1, 1, 0.9400, 0.8900, 0.8200, 0.6400, 0.5100, 0.4300, 0.3800, 0.3500, 0.3200, 0.3000, 0.2700, 0.2600, 0.2400, 0.2300, 0.2100, 0.2000, 0.2000, 0.1900, 0.1900, 0.1800, 0.1800, 0.1800, 0.1700, 0.1600, 0.1600, 0.1500, 0.1400, 0, 0,
		1, 1, 0.9400, 0.8900, 0.8300, 0.6400, 0.5200, 0.4600, 0.4200, 0.3900, 0.3500, 0.3300, 0.3100, 0.2900, 0.2800, 0.2700, 0.2600, 0.2600, 0.2500, 0.2400, 0.2300, 0.2300, 0.2200, 0.2200, 0.2200, 0.2100, 0.2000, 0.1900, 0.1800, 0, 0,
		1, 1, 0.9400, 0.8900, 0.8400, 0.6800, 0.5700, 0.5100, 0.4600, 0.4200, 0.4000, 0.3800, 0.3600, 0.3400, 0.3200, 0.3100, 0.3000, 0.3000, 0.3000, 0.2900, 0.2900, 0.2800, 0.2800, 0.2800, 0.2700, 0.2600, 0.2500, 0.2400, 0.2300, 0, 0,
		1, 1, 0.9600, 0.9100, 0.8400, 0.6800, 0.5700, 0.5200, 0.4800, 0.4500, 0.4200, 0.4000, 0.3900, 0.3800, 0.3700, 0.3600, 0.3600, 0.3500, 0.3500, 0.3400, 0.3400, 0.3300, 0.3300, 0.3300, 0.3200, 0.3100, 0.2900, 0.2700, 0.2500, 0, 0,
		1, 1, 0.9600, 0.9200, 0.8600, 0.6900, 0.5900, 0.5300, 0.4900, 0.4600, 0.4400, 0.4200, 0.4000, 0.3900, 0.3900, 0.3800, 0.3700, 0.3600, 0.3600, 0.3600, 0.3500, 0.3500, 0.3500, 0.3400, 0.3400, 0.3300, 0.3200, 0.3100, 0.3000, 0, 0,
		1, 1, 0.9600, 0.9200, 0.8600, 0.7100, 0.6100, 0.5500, 0.5200, 0.4900, 0.4700, 0.4500, 0.4400, 0.4300, 0.4200, 0.4100, 0.4000, 0.4000, 0.3900, 0.3900, 0.3800, 0.3800, 0.3800, 0.3800, 0.3700, 0.3700, 0.3500, 0.3400, 0.3400, 0, 0,
		1, 1, 0.9600, 0.9200, 0.8600, 0.7200, 0.6200, 0.5600, 0.5200, 0.4900, 0.4700, 0.4500, 0.4400, 0.4400, 0.4300, 0.4200, 0.4200, 0.4100, 0.4100, 0.4100, 0.4000, 0.4000, 0.4000, 0.4000, 0.4000, 0.3900, 0.3900, 0.3800, 0.3700, 0, 0,
		1, 1, 0.9600, 0.9200, 0.8700, 0.7300, 0.6400, 0.5800, 0.5500, 0.5300, 0.5100, 0.4900, 0.4800, 0.4800, 0.4700, 0.4600, 0.4600, 0.4500, 0.4500, 0.4400, 0.4400, 0.4400, 0.4300, 0.4300, 0.4300, 0.4200, 0.4100, 0.4100, 0.4100, 0, 0,
		1, 1, 0.9600, 0.9300, 0.8800, 0.7400, 0.6500, 0.6000, 0.5700, 0.5400, 0.5300, 0.5100, 0.5000, 0.4900, 0.4800, 0.4800, 0.4700, 0.4600, 0.4600, 0.4500, 0.4500, 0.4500, 0.4500, 0.4500, 0.4400, 0.4400, 0.4400, 0.4300, 0.4300, 0, 0,
		1, 1, 0.9600, 0.9300, 0.8800, 0.7500, 0.6700, 0.6200, 0.5900, 0.5600, 0.5400, 0.5300, 0.5200, 0.5100, 0.5100, 0.5000, 0.5000, 0.5000, 0.4900, 0.4900, 0.4900, 0.4900, 0.4900, 0.4800, 0.4800, 0.4800, 0.4700, 0.4600, 0.4600, 0, 0,
		1, 1, 0.9600, 0.9300, 0.8800, 0.7500, 0.6700, 0.6200, 0.5900, 0.5600, 0.5500, 0.5400, 0.5300, 0.5200, 0.5200, 0.5100, 0.5100, 0.5100, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.4900, 0.4900, 0.4900, 0.4900, 0.4800, 0.4700, 0, 0,
		1, 1, 0.9600, 0.9300, 0.8900, 0.7700, 0.6800, 0.6400, 0.6200, 0.6000, 0.5800, 0.5700, 0.5600, 0.5600, 0.5500, 0.5400, 0.5400, 0.5300, 0.5300, 0.5200, 0.5200, 0.5100, 0.5100, 0.5100, 0.5100, 0.5100, 0.5000, 0.5000, 0.5000, 0, 0,
		1, 1, 0.9600, 0.9300, 0.8900, 0.7800, 0.6900, 0.6500, 0.6200, 0.6000, 0.5900, 0.5800, 0.5600, 0.5600, 0.5500, 0.5500, 0.5400, 0.5400, 0.5400, 0.5400, 0.5300, 0.5300, 0.5300, 0.5300, 0.5300, 0.5300, 0.5200, 0.5100, 0.5100, 0, 0,
		1, 1, 0.9600, 0.9300, 0.9000, 0.8000, 0.7200, 0.6700, 0.6500, 0.6300, 0.6200, 0.6100, 0.6000, 0.5900, 0.5900, 0.5800, 0.5800, 0.5800, 0.5800, 0.5700, 0.5700, 0.5700, 0.5600, 0.5600, 0.5600, 0.5500, 0.5500, 0.5400, 0.5400, 0, 0,
		1, 1, 0.9600, 0.9300, 0.9000, 0.8000, 0.7200, 0.6700, 0.6500, 0.6400, 0.6200, 0.6100, 0.6100, 0.6000, 0.6000, 0.5900, 0.5900, 0.5900, 0.5800, 0.5800, 0.5800, 0.5800, 0.5800, 0.5700, 0.5700, 0.5700, 0.5600, 0.5500, 0.5500, 0, 0,
		1, 1, 0.9600, 0.9300, 0.9000, 0.8000, 0.7200, 0.6900, 0.6700, 0.6500, 0.6400, 0.6300, 0.6200, 0.6100, 0.6100, 0.6000, 0.6000, 0.5900, 0.5900, 0.5900, 0.5900, 0.5900, 0.5900, 0.5900, 0.5800, 0.5800, 0.5700, 0.5700, 0.5700, 0, 0,
		1, 1, 0.9600, 0.9400, 0.9000, 0.8000, 0.7200, 0.6900, 0.6700, 0.6600, 0.6500, 0.6400, 0.6400, 0.6300, 0.6300, 0.6200, 0.6200, 0.6100, 0.6100, 0.6100, 0.6100, 0.6100, 0.6100, 0.6100, 0.6100, 0.6000, 0.6000, 0.5900, 0.5900, 0, 0,
		1, 1, 0.9600, 0.9400, 0.9000, 0.8000, 0.7200, 0.6900, 0.6700, 0.6600, 0.6500, 0.6500, 0.6500, 0.6500, 0.6400, 0.6400, 0.6300, 0.6300, 0.6300, 0.6300, 0.6200, 0.6200, 0.6200, 0.6200, 0.6200, 0.6100, 0.6100, 0.6000, 0.6000, 0, 0,
		1, 1, 0.9600, 0.9400, 0.9000, 0.8100, 0.7400, 0.7100, 0.7000, 0.6800, 0.6700, 0.6600, 0.6600, 0.6500, 0.6400, 0.6400, 0.6300, 0.6300, 0.6300, 0.6300, 0.6200, 0.6200, 0.6200, 0.6200, 0.6200, 0.6100, 0.6100, 0.6100, 0.6000, 0, 0,
		1, 1, 0.9700, 0.9400, 0.9100, 0.8200, 0.7600, 0.7400, 0.7200, 0.7100, 0.7000, 0.6900, 0.6800, 0.6700, 0.6700, 0.6600, 0.6600, 0.6600, 0.6600, 0.6500, 0.6500, 0.6500, 0.6500, 0.6500, 0.6400, 0.6400, 0.6400, 0.6400, 0.6300, 0, 0,
		1, 1, 0.9700, 0.9400, 0.9100, 0.8200, 0.7600, 0.7400, 0.7200, 0.7100, 0.7000, 0.6900, 0.6900, 0.6800, 0.6800, 0.6700, 0.6700, 0.6700, 0.6600, 0.6600, 0.6600, 0.6600, 0.6600, 0.6500, 0.6500, 0.6400, 0.6400, 0.6400, 0.6400, 0, 0,
		1, 1, 0.9700, 0.9400, 0.9100, 0.8200, 0.7700, 0.7400, 0.7200, 0.7100, 0.7000, 0.6900, 0.6900, 0.6800, 0.6800, 0.6800, 0.6700, 0.6700, 0.6700, 0.6700, 0.6700, 0.6700, 0.6600, 0.6600, 0.6600, 0.6600, 0.6600, 0.6500, 0.6500, 0, 0,
		1, 1, 0.9800, 0.9500, 0.9200, 0.8400, 0.7900, 0.7600, 0.7400, 0.7200, 0.7100, 0.7100, 0.7000, 0.7000, 0.6900, 0.6900, 0.6900, 0.6800, 0.6800, 0.6800, 0.6800, 0.6800, 0.6700, 0.6700, 0.6700, 0.6700, 0.6600, 0.6600, 0.6600, 0, 0,
		1, 1, 0.9800, 0.9500, 0.9200, 0.8400, 0.7900, 0.7600, 0.7500, 0.7200, 0.7100, 0.7100, 0.7100, 0.7100, 0.7100, 0.7000, 0.7000, 0.7000, 0.6900, 0.6900, 0.6900, 0.6800, 0.6700, 0.6700, 0.6700, 0.6700, 0.6600, 0.6600, 0.6600, 0, 0,
		1, 1, 0.9800, 0.9500, 0.9200, 0.8400, 0.7900, 0.7600, 0.7500, 0.7300, 0.7200, 0.7200, 0.7100, 0.7100, 0.7100, 0.7000, 0.7000, 0.7000, 0.6900, 0.6900, 0.6900, 0.6900, 0.6900, 0.6800, 0.6800, 0.6800, 0.6800, 0.6800, 0.6800, 0, 0,
		1, 1, 0.9800, 0.9500, 0.9200, 0.8400, 0.7900, 0.7700, 0.7500, 0.7400, 0.7300, 0.7200, 0.7100, 0.7100, 0.7100, 0.7000, 0.7000, 0.7000, 0.7000, 0.6900, 0.6900, 0.6900, 0.6900, 0.6900, 0.6900, 0.6800, 0.6800, 0.6800, 0.6800, 0, 0,
		1, 1, 0.9800, 0.9500, 0.9300, 0.8500, 0.8100, 0.7800, 0.7700, 0.7500, 0.7400, 0.7400, 0.7300, 0.7300, 0.7200, 0.7200, 0.7100, 0.7100, 0.7100, 0.7100, 0.7100, 0.7100, 0.7100, 0.7100, 0.7100, 0.7000, 0.7000, 0.7000, 0.7000, 0, 0,
		1, 1, 0.9800, 0.9500, 0.9300, 0.8500, 0.8100, 0.7800, 0.7700, 0.7500, 0.7500, 0.7400, 0.7400, 0.7300, 0.7300, 0.7300, 0.7200, 0.7200, 0.7200, 0.7200, 0.7200, 0.7200, 0.7100, 0.7100, 0.7100, 0.7100, 0.7100, 0.7100, 0.7000, 0, 0,
		1, 1, 0.9800, 0.9500, 0.9300, 0.8600, 0.8200, 0.7900, 0.7800, 0.7700, 0.7600, 0.7500, 0.7400, 0.7400, 0.7400, 0.7300, 0.7300, 0.7300, 0.7300, 0.7300, 0.7300, 0.7300, 0.7300, 0.7200, 0.7200, 0.7200, 0.7100, 0.7100, 0.7100, 0, 0,
		1, 1, 0.9800, 0.9500, 0.9400, 0.8600, 0.8200, 0.7900, 0.7800, 0.7700, 0.7600, 0.7500, 0.7500, 0.7400, 0.7400, 0.7400, 0.7400, 0.7300, 0.7300, 0.7300, 0.7300, 0.7300, 0.7300, 0.7300, 0.7300, 0.7200, 0.7200, 0.7100, 0.7100, 0, 0,
		1, 1, 0.9800, 0.9600, 0.9400, 0.8600, 0.8200, 0.8000, 0.7800, 0.7700, 0.7600, 0.7600, 0.7500, 0.7500, 0.7500, 0.7500, 0.7400, 0.7400, 0.7400, 0.7400, 0.7400, 0.7400, 0.7300, 0.7300, 0.7300, 0.7300, 0.7300, 0.7300, 0.7300, 0, 0,
		1, 1, 0.9800, 0.9600, 0.9400, 0.8600, 0.8200, 0.8000, 0.7900, 0.7800, 0.7700, 0.7600, 0.7600, 0.7500, 0.7500, 0.7500, 0.7500, 0.7500, 0.7400, 0.7400, 0.7400, 0.7400, 0.7400, 0.7400, 0.7400, 0.7400, 0.7300, 0.7300, 0.7300, 0, 0,
		1, 1, 0.9800, 0.9600, 0.9400, 0.8700, 0.8300, 0.8100, 0.7900, 0.7800, 0.7700, 0.7700, 0.7600, 0.7600, 0.7600, 0.7500, 0.7500, 0.7500, 0.7500, 0.7500, 0.7500, 0.7500, 0.7500, 0.7500, 0.7500, 0.7400, 0.7400, 0.7400, 0.7400, 0, 0,
		1, 1, 0.9800, 0.9600, 0.9400, 0.8800, 0.8300, 0.8100, 0.8000, 0.7900, 0.7800, 0.7700, 0.7700, 0.7700, 0.7600, 0.7600, 0.7600, 0.7600, 0.7600, 0.7600, 0.7600, 0.7600, 0.7600, 0.7500, 0.7500, 0.7500, 0.7500, 0.7500, 0.7500, 0, 0,
		1, 1, 0.9900, 0.9600, 0.9400, 0.8800, 0.8400, 0.8200, 0.8100, 0.7900, 0.7800, 0.7800, 0.7700, 0.7700, 0.7700, 0.7700, 0.7600, 0.7600, 0.7600, 0.7600, 0.7600, 0.7600, 0.7600, 0.7600, 0.7600, 0.7600, 0.7600, 0.7600, 0.7500, 0, 0,
		1, 1, 0.9900, 0.9600, 0.9400, 0.8800, 0.8400, 0.8200, 0.8100, 0.8000, 0.7900, 0.7800, 0.7800, 0.7800, 0.7700, 0.7700, 0.7700, 0.7700, 0.7700, 0.7700, 0.7600, 0.7600, 0.7600, 0.7600, 0.7600, 0.7600, 0.7600, 0.7600, 0.7600, 0, 0,
		1, 1, 0.9900, 0.9600, 0.9400, 0.8800, 0.8500, 0.8300, 0.8100, 0.8000, 0.7900, 0.7900, 0.7800, 0.7800, 0.7800, 0.7700, 0.7700, 0.7700, 0.7700, 0.7700, 0.7700, 0.7600, 0.7600, 0.7600, 0.7600, 0.7600, 0.7600, 0.7600, 0.7600, 0, 0,
		1, 1, 0.9900, 0.9600, 0.9400, 0.8800, 0.8500, 0.8300, 0.8200, 0.8000, 0.8000, 0.7900, 0.7900, 0.7800, 0.7800, 0.7800, 0.7800, 0.7700, 0.7700, 0.7700, 0.7700, 0.7700, 0.7700, 0.7700, 0.7700, 0.7700, 0.7600, 0.7600, 0.7600, 0, 0,
		1, 1, 0.9900, 0.9600, 0.9400, 0.8800, 0.8500, 0.8300, 0.8200, 0.8100, 0.8000, 0.7900, 0.7900, 0.7900, 0.7800, 0.7800, 0.7800, 0.7800, 0.7800, 0.7800, 0.7700, 0.7700, 0.7700, 0.7700, 0.7700, 0.7700, 0.7700, 0.7600, 0.7600, 0, 0,
		1, 1, 0.9900, 0.9600, 0.9400, 0.8800, 0.8500, 0.8400, 0.8200, 0.8100, 0.8100, 0.8000, 0.7900, 0.7900, 0.7900, 0.7800, 0.7800, 0.7800, 0.7800, 0.7800, 0.7800, 0.7800, 0.7800, 0.7800, 0.7800, 0.7800, 0.7700, 0.7700, 0.7700, 0, 0,
		1, 1, 0.9900, 0.9600, 0.9400, 0.8800, 0.8500, 0.8400, 0.8300, 0.8100, 0.8100, 0.8100, 0.8000, 0.7900, 0.7900, 0.7900, 0.7900, 0.7900, 0.7800, 0.7800, 0.7800, 0.7800, 0.7800, 0.7800, 0.7800, 0.7800, 0.7800, 0.7700, 0.7700, 0, 0,
		1, 1, 0.9900, 0.9600, 0.9400, 0.8800, 0.8500, 0.8400, 0.8300, 0.8200, 0.8100, 0.8100, 0.8100, 0.8000, 0.7900, 0.7900, 0.7900, 0.7900, 0.7900, 0.7900, 0.7900, 0.7900, 0.7900, 0.7900, 0.7900, 0.7800, 0.7800, 0.7800, 0.7700, 0, 0,
		1, 1, 0.9900, 0.9600, 0.9400, 0.8900, 0.8500, 0.8400, 0.8300, 0.8200, 0.8200, 0.8100, 0.8100, 0.8000, 0.8000, 0.8000, 0.8000, 0.8000, 0.8000, 0.8000, 0.7900, 0.7900, 0.7900, 0.7900, 0.7900, 0.7900, 0.7900, 0.7800, 0.7800, 0, 0,
		1, 1, 0.9900, 0.9600, 0.9400, 0.8900, 0.8500, 0.8400, 0.8300, 0.8300, 0.8200, 0.8100, 0.8100, 0.8100, 0.8100, 0.8000, 0.8000, 0.8000, 0.8000, 0.8000, 0.8000, 0.8000, 0.8000, 0.8000, 0.8000, 0.7900, 0.7900, 0.7900, 0.7800, 0, 0,
		1, 1, 0.9900, 0.9600, 0.9400, 0.8900, 0.8500, 0.8400, 0.8300, 0.8300, 0.8200, 0.8200, 0.8100, 0.8100, 0.8100, 0.8100, 0.8100, 0.8100, 0.8100, 0.8000, 0.8000, 0.8000, 0.8000, 0.8000, 0.8000, 0.8000, 0.7900, 0.7900, 0.7900, 0, 0,
		1, 1, 0.9900, 0.9700, 0.9500, 0.9100, 0.8700, 0.8500, 0.8400, 0.8300, 0.8200, 0.8200, 0.8200, 0.8100, 0.8100, 0.8100, 0.8100, 0.8100, 0.8100, 0.8100, 0.8000, 0.8000, 0.8000, 0.8000, 0.8000, 0.8000, 0.8000, 0.8000, 0.8000, 0, 0,
		1, 1, 0.9900, 0.9700, 0.9500, 0.9100, 0.8800, 0.8500, 0.8400, 0.8300, 0.8300, 0.8200, 0.8200, 0.8200, 0.8200, 0.8200, 0.8100, 0.8100, 0.8100, 0.8100, 0.8100, 0.8100, 0.8100, 0.8100, 0.8100, 0.8100, 0.8100, 0.8000, 0.8000, 0, 0,
		1, 1, 0.9900, 0.9700, 0.9500, 0.9100, 0.8800, 0.8600, 0.8400, 0.8300, 0.8300, 0.8300, 0.8200, 0.8200, 0.8200, 0.8200, 0.8200, 0.8200, 0.8200, 0.8200, 0.8200, 0.8200, 0.8100, 0.8100, 0.8100, 0.8100, 0.8100, 0.8100, 0.8100, 0, 0,
		1, 1, 0.9900, 0.9700, 0.9500, 0.9100, 0.8800, 0.8600, 0.8500, 0.8400, 0.8400, 0.8300, 0.8300, 0.8300, 0.8300, 0.8200, 0.8200, 0.8200, 0.8200, 0.8200, 0.8200, 0.8200, 0.8200, 0.8200, 0.8200, 0.8100, 0.8100, 0.8100, 0.8100, 0, 0,
		1, 1, 0.9900, 0.9700, 0.9500, 0.9100, 0.8800, 0.8600, 0.8500, 0.8400, 0.8400, 0.8400, 0.8400, 0.8300, 0.8300, 0.8300, 0.8300, 0.8300, 0.8200, 0.8200, 0.8200, 0.8200, 0.8200, 0.8200, 0.8200, 0.8200, 0.8100, 0.8100, 0.8100, 0, 0,
		1, 1, 0.9900, 0.9700, 0.9500, 0.9100, 0.8800, 0.8600, 0.8500, 0.8500, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8300, 0.8300, 0.8300, 0.8300, 0.8300, 0.8300, 0.8300, 0.8200, 0.8200, 0.8200, 0.8200, 0.8200, 0.8100, 0.8100, 0, 0,
		1, 1, 0.9900, 0.9700, 0.9500, 0.9100, 0.8800, 0.8600, 0.8500, 0.8500, 0.8500, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8300, 0.8300, 0.8300, 0.8300, 0.8300, 0.8200, 0.8200, 0.8200, 0.8200, 0.8200, 0.8200, 0, 0,
		1, 1, 0.9900, 0.9700, 0.9500, 0.9100, 0.8800, 0.8600, 0.8500, 0.8500, 0.8500, 0.8500, 0.8500, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8300, 0.8300, 0.8300, 0.8300, 0.8300, 0.8300, 0.8200, 0.8200, 0, 0,
		1, 1, 0.9900, 0.9700, 0.9500, 0.9100, 0.8800, 0.8600, 0.8500, 0.8500, 0.8500, 0.8500, 0.8500, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8300, 0.8300, 0.8300, 0.8300, 0.8300, 0.8300, 0.8200, 0.8200, 0, 0,
		1, 1, 0.9900, 0.9700, 0.9500, 0.9100, 0.8800, 0.8700, 0.8600, 0.8600, 0.8500, 0.8500, 0.8500, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8300, 0.8300, 0.8300, 0.8300, 0.8300, 0.8300, 0.8300, 0.8200, 0, 0,
		1, 1, 0.9900, 0.9700, 0.9500, 0.9100, 0.8800, 0.8700, 0.8600, 0.8600, 0.8600, 0.8500, 0.8500, 0.8500, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8300, 0.8300, 0.8300, 0.8300, 0.8300, 0, 0,
		1, 1, 0.9900, 0.9700, 0.9500, 0.9100, 0.8800, 0.8700, 0.8600, 0.8600, 0.8600, 0.8600, 0.8500, 0.8500, 0.8500, 0.8500, 0.8500, 0.8500, 0.8500, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8400, 0.8300, 0.8300, 0, 0,
		1, 1, 0.9900, 0.9700, 0.9600, 0.9100, 0.8800, 0.8800, 0.8700, 0.8700, 0.8600, 0.8600, 0.8600, 0.8600, 0.8600, 0.8600, 0.8600, 0.8500, 0.8500, 0.8500, 0.8500, 0.8500, 0.8500, 0.8500, 0.8500, 0.8400, 0.8400, 0.8400, 0.8400, 0, 0};

	static float64_t table10[1271]={0, 0.0100, 0.0110, 0.0160, 0.0210, 0.0260, 0.0310, 0.0360, 0.0410, 0.0460, 0.0510, 0.0560, 0.0610, 0.0660, 0.0710, 0.0760, 0.0810, 0.0860, 0.0910, 0.0960, 0.1200, 0.1500, 0.2000, 0.2500, 0.3000, 0.3500, 0.4000, 0.4500, 0.4990, 0.5000, 1,
		1, 1, 0.9634, 0.7998, 0.6824, 0.5879, 0.5197, 0.4784, 0.4391, 0.4109, 0.3879, 0.3673, 0.3492, 0.3337, 0.3209, 0.3100, 0.3002, 0.2912, 0.2824, 0.2735, 0.2293, 0.1735, 0.0986, 0.0393, 0.0210, 0.0113, 0.0112, 0.0111, 0.0086, 0, 0,
		1, 1, 0.9662, 0.8148, 0.7027, 0.6139, 0.5513, 0.5086, 0.4715, 0.4430, 0.4186, 0.3968, 0.3777, 0.3610, 0.3470, 0.3350, 0.3245, 0.3148, 0.3055, 0.2957, 0.2497, 0.2026, 0.1391, 0.0908, 0.0711, 0.0599, 0.0554, 0.0519, 0.0483, 0, 0,
		1, 1, 0.9690, 0.8299, 0.7231, 0.6399, 0.5829, 0.5387, 0.5039, 0.4751, 0.4493, 0.4264, 0.4062, 0.3884, 0.3730, 0.3600, 0.3488, 0.3385, 0.3285, 0.3179, 0.2700, 0.2318, 0.1797, 0.1423, 0.1211, 0.1086, 0.0997, 0.0928, 0.0881, 0, 0,
		1, 1, 0.9713, 0.8406, 0.7434, 0.6720, 0.6153, 0.5707, 0.5337, 0.5023, 0.4754, 0.4515, 0.4302, 0.4117, 0.3962, 0.3834, 0.3723, 0.3620, 0.3528, 0.3441, 0.2989, 0.2595, 0.2180, 0.1873, 0.1688, 0.1538, 0.1425, 0.1337, 0.1278, 0, 0,
		1, 1, 0.9732, 0.8514, 0.7620, 0.7004, 0.6499, 0.5993, 0.5535, 0.5222, 0.4959, 0.4734, 0.4535, 0.4352, 0.4181, 0.4027, 0.3893, 0.3782, 0.3685, 0.3595, 0.3241, 0.2893, 0.2580, 0.2354, 0.2135, 0.1971, 0.1848, 0.1751, 0.1676, 0, 0,
		1, 1, 0.9780, 0.8781, 0.7951, 0.7296, 0.6794, 0.6427, 0.6108, 0.5830, 0.5589, 0.5380, 0.5199, 0.5041, 0.4902, 0.4776, 0.4659, 0.4547, 0.4439, 0.4336, 0.3954, 0.3657, 0.3283, 0.2973, 0.2730, 0.2541, 0.2389, 0.2291, 0.2231, 0, 0,
		1, 1, 0.9777, 0.8799, 0.7998, 0.7405, 0.7005, 0.6693, 0.6433, 0.6200, 0.5990, 0.5803, 0.5639, 0.5498, 0.5369, 0.5247, 0.5133, 0.5026, 0.4928, 0.4838, 0.4540, 0.4295, 0.4013, 0.3790, 0.3607, 0.3459, 0.3340, 0.3245, 0.3161, 0, 0,
		1, 1, 0.9786, 0.8836, 0.8191, 0.7750, 0.7422, 0.7145, 0.6893, 0.6668, 0.6469, 0.6297, 0.6151, 0.6029, 0.5923, 0.5828, 0.5742, 0.5664, 0.5590, 0.5518, 0.5182, 0.4859, 0.4498, 0.4209, 0.3977, 0.3831, 0.3721, 0.3613, 0.3569, 0, 0,
		1, 1, 0.9801, 0.8905, 0.8289, 0.7873, 0.7556, 0.7290, 0.7045, 0.6820, 0.6617, 0.6439, 0.6289, 0.6170, 0.6072, 0.5983, 0.5901, 0.5825, 0.5755, 0.5687, 0.5395, 0.5118, 0.4799, 0.4554, 0.4362, 0.4242, 0.4153, 0.4085, 0.4059, 0, 0,
		1, 1, 0.9816, 0.8973, 0.8386, 0.7996, 0.7690, 0.7434, 0.7197, 0.6972, 0.6765, 0.6581, 0.6428, 0.6311, 0.6221, 0.6137, 0.6059, 0.5987, 0.5919, 0.5856, 0.5607, 0.5378, 0.5099, 0.4899, 0.4747, 0.4654, 0.4585, 0.4557, 0.4549, 0, 0,
		1, 1, 0.9761, 0.8969, 0.8423, 0.8024, 0.7723, 0.7490, 0.7276, 0.7075, 0.6894, 0.6735, 0.6598, 0.6483, 0.6385, 0.6295, 0.6213, 0.6139, 0.6069, 0.6008, 0.5801, 0.5620, 0.5389, 0.5217, 0.5089, 0.5010, 0.4950, 0.4913, 0.4888, 0, 0,
		1, 1, 0.9706, 0.8964, 0.8460, 0.8052, 0.7755, 0.7545, 0.7355, 0.7177, 0.7024, 0.6889, 0.6767, 0.6654, 0.6550, 0.6453, 0.6368, 0.6291, 0.6219, 0.6160, 0.5995, 0.5863, 0.5680, 0.5535, 0.5432, 0.5366, 0.5314, 0.5269, 0.5226, 0, 0,
		1, 1, 0.9761, 0.9053, 0.8565, 0.8202, 0.7927, 0.7721, 0.7542, 0.7378, 0.7232, 0.7104, 0.6988, 0.6884, 0.6792, 0.6709, 0.6633, 0.6563, 0.6498, 0.6441, 0.6252, 0.6100, 0.5921, 0.5798, 0.5710, 0.5648, 0.5593, 0.5543, 0.5498, 0, 0,
		1, 1, 0.9817, 0.9142, 0.8670, 0.8351, 0.8099, 0.7896, 0.7729, 0.7578, 0.7441, 0.7318, 0.7209, 0.7114, 0.7034, 0.6964, 0.6898, 0.6836, 0.6778, 0.6723, 0.6508, 0.6337, 0.6161, 0.6061, 0.5989, 0.5929, 0.5872, 0.5817, 0.5771, 0, 0,
		1, 1, 0.9810, 0.9203, 0.8778, 0.8445, 0.8188, 0.7972, 0.7787, 0.7634, 0.7507, 0.7393, 0.7293, 0.7207, 0.7130, 0.7058, 0.6991, 0.6928, 0.6870, 0.6817, 0.6621, 0.6497, 0.6369, 0.6283, 0.6214, 0.6164, 0.6129, 0.6101, 0.6086, 0, 0,
		1, 1, 0.9841, 0.9140, 0.8681, 0.8439, 0.8263, 0.8094, 0.7941, 0.7801, 0.7671, 0.7561, 0.7469, 0.7380, 0.7294, 0.7213, 0.7137, 0.7069, 0.7008, 0.6956, 0.6811, 0.6696, 0.6573, 0.6475, 0.6395, 0.6340, 0.6314, 0.6298, 0.6285, 0, 0,
		1, 1, 0.9842, 0.9220, 0.8792, 0.8546, 0.8351, 0.8175, 0.8022, 0.7888, 0.7768, 0.7665, 0.7577, 0.7495, 0.7419, 0.7348, 0.7280, 0.7217, 0.7160, 0.7109, 0.6957, 0.6850, 0.6725, 0.6621, 0.6544, 0.6489, 0.6453, 0.6429, 0.6417, 0, 0,
		1, 1, 0.9842, 0.9301, 0.8903, 0.8653, 0.8439, 0.8257, 0.8104, 0.7974, 0.7864, 0.7769, 0.7685, 0.7611, 0.7544, 0.7482, 0.7423, 0.7366, 0.7312, 0.7261, 0.7103, 0.7004, 0.6876, 0.6766, 0.6693, 0.6638, 0.6593, 0.6561, 0.6549, 0, 0,
		1, 1, 0.9868, 0.9341, 0.8949, 0.8703, 0.8494, 0.8315, 0.8165, 0.8038, 0.7932, 0.7842, 0.7763, 0.7692, 0.7629, 0.7573, 0.7521, 0.7474, 0.7430, 0.7388, 0.7238, 0.7120, 0.6995, 0.6908, 0.6852, 0.6813, 0.6781, 0.6759, 0.6751, 0, 0,
		1, 1, 0.9894, 0.9382, 0.8994, 0.8754, 0.8548, 0.8373, 0.8226, 0.8102, 0.8000, 0.7915, 0.7840, 0.7773, 0.7715, 0.7664, 0.7619, 0.7581, 0.7547, 0.7514, 0.7373, 0.7235, 0.7113, 0.7051, 0.7011, 0.6988, 0.6970, 0.6958, 0.6953, 0, 0,
		1, 1, 0.9874, 0.9378, 0.9032, 0.8811, 0.8621, 0.8458, 0.8318, 0.8198, 0.8093, 0.8000, 0.7918, 0.7845, 0.7781, 0.7727, 0.7680, 0.7637, 0.7596, 0.7558, 0.7417, 0.7326, 0.7234, 0.7173, 0.7121, 0.7083, 0.7068, 0.7057, 0.7052, 0, 0,
		1, 1, 0.9875, 0.9414, 0.9089, 0.8841, 0.8666, 0.8526, 0.8408, 0.8309, 0.8229, 0.8165, 0.8108, 0.8054, 0.8003, 0.7954, 0.7908, 0.7865, 0.7824, 0.7786, 0.7635, 0.7517, 0.7416, 0.7304, 0.7201, 0.7147, 0.7139, 0.7134, 0.7132, 0, 0,
		1, 1, 0.9868, 0.9421, 0.9109, 0.8878, 0.8711, 0.8577, 0.8462, 0.8364, 0.8283, 0.8215, 0.8153, 0.8095, 0.8040, 0.7989, 0.7941, 0.7897, 0.7857, 0.7821, 0.7684, 0.7575, 0.7475, 0.7389, 0.7314, 0.7269, 0.7252, 0.7239, 0.7231, 0, 0,
		1, 1, 0.9862, 0.9428, 0.9129, 0.8916, 0.8755, 0.8627, 0.8516, 0.8419, 0.8337, 0.8266, 0.8199, 0.8136, 0.8077, 0.8023, 0.7974, 0.7929, 0.7890, 0.7856, 0.7733, 0.7634, 0.7533, 0.7474, 0.7428, 0.7392, 0.7366, 0.7344, 0.7331, 0, 0,
		1, 1, 0.9890, 0.9475, 0.9161, 0.8952, 0.8789, 0.8653, 0.8535, 0.8433, 0.8348, 0.8276, 0.8214, 0.8158, 0.8107, 0.8060, 0.8017, 0.7978, 0.7943, 0.7913, 0.7802, 0.7718, 0.7631, 0.7577, 0.7534, 0.7501, 0.7479, 0.7464, 0.7455, 0, 0,
		1, 1, 0.9919, 0.9522, 0.9193, 0.8988, 0.8824, 0.8679, 0.8554, 0.8447, 0.8358, 0.8286, 0.8229, 0.8181, 0.8136, 0.8096, 0.8060, 0.8026, 0.7996, 0.7969, 0.7871, 0.7802, 0.7728, 0.7680, 0.7640, 0.7610, 0.7592, 0.7583, 0.7579, 0, 0,
		1, 1, 0.9880, 0.9462, 0.9196, 0.8981, 0.8820, 0.8695, 0.8588, 0.8494, 0.8412, 0.8336, 0.8267, 0.8207, 0.8160, 0.8120, 0.8084, 0.8052, 0.8023, 0.7997, 0.7906, 0.7850, 0.7797, 0.7749, 0.7707, 0.7668, 0.7656, 0.7650, 0.7649, 0, 0,
		1, 1, 0.9921, 0.9590, 0.9296, 0.9054, 0.8890, 0.8766, 0.8669, 0.8597, 0.8536, 0.8479, 0.8425, 0.8374, 0.8327, 0.8283, 0.8242, 0.8205, 0.8172, 0.8142, 0.8051, 0.7984, 0.7903, 0.7851, 0.7815, 0.7786, 0.7765, 0.7758, 0.7758, 0, 0,
		1, 1, 0.9901, 0.9553, 0.9276, 0.9061, 0.8909, 0.8795, 0.8706, 0.8632, 0.8567, 0.8505, 0.8448, 0.8395, 0.8347, 0.8303, 0.8263, 0.8227, 0.8196, 0.8167, 0.8069, 0.8008, 0.7943, 0.7894, 0.7857, 0.7830, 0.7810, 0.7799, 0.7796, 0, 0,
		1, 1, 0.9882, 0.9515, 0.9256, 0.9068, 0.8929, 0.8824, 0.8742, 0.8667, 0.8597, 0.8531, 0.8471, 0.8416, 0.8367, 0.8322, 0.8283, 0.8249, 0.8219, 0.8191, 0.8087, 0.8031, 0.7982, 0.7937, 0.7899, 0.7873, 0.7854, 0.7840, 0.7834, 0, 0,
		1, 1, 0.9920, 0.9635, 0.9398, 0.9196, 0.9025, 0.8885, 0.8778, 0.8699, 0.8631, 0.8569, 0.8513, 0.8463, 0.8418, 0.8379, 0.8344, 0.8315, 0.8289, 0.8265, 0.8170, 0.8103, 0.8033, 0.7975, 0.7926, 0.7899, 0.7889, 0.7882, 0.7879, 0, 0,
		1, 1, 0.9958, 0.9754, 0.9540, 0.9325, 0.9122, 0.8947, 0.8814, 0.8732, 0.8666, 0.8607, 0.8555, 0.8510, 0.8470, 0.8435, 0.8406, 0.8380, 0.8358, 0.8338, 0.8254, 0.8175, 0.8085, 0.8013, 0.7954, 0.7924, 0.7923, 0.7923, 0.7923, 0, 0,
		1, 1, 0.9958, 0.9754, 0.9540, 0.9325, 0.9122, 0.8947, 0.8814, 0.8732, 0.8666, 0.8607, 0.8555, 0.8510, 0.8470, 0.8435, 0.8406, 0.8380, 0.8358, 0.8338, 0.8254, 0.8175, 0.8085, 0.8013, 0.7954, 0.7924, 0.7923, 0.7923, 0.7923, 0, 0,
		1, 1, 0.9958, 0.9754, 0.9540, 0.9325, 0.9122, 0.8947, 0.8814, 0.8732, 0.8666, 0.8607, 0.8555, 0.8510, 0.8470, 0.8435, 0.8406, 0.8380, 0.8358, 0.8338, 0.8254, 0.8175, 0.8085, 0.8013, 0.7954, 0.7924, 0.7923, 0.7923, 0.7923, 0, 0,
		1, 1, 0.9958, 0.9754, 0.9540, 0.9325, 0.9122, 0.8947, 0.8814, 0.8732, 0.8666, 0.8607, 0.8555, 0.8510, 0.8470, 0.8435, 0.8406, 0.8380, 0.8358, 0.8338, 0.8254, 0.8175, 0.8085, 0.8013, 0.7954, 0.7924, 0.7923, 0.7923, 0.7923, 0, 0,
		1, 1, 0.9958, 0.9754, 0.9540, 0.9325, 0.9122, 0.8947, 0.8814, 0.8732, 0.8666, 0.8607, 0.8555, 0.8510, 0.8470, 0.8435, 0.8406, 0.8380, 0.8358, 0.8338, 0.8254, 0.8175, 0.8085, 0.8013, 0.7954, 0.7924, 0.7923, 0.7923, 0.7923, 0, 0,
		1, 1, 0.9958, 0.9754, 0.9540, 0.9325, 0.9122, 0.8947, 0.8814, 0.8732, 0.8666, 0.8607, 0.8555, 0.8510, 0.8470, 0.8435, 0.8406, 0.8380, 0.8358, 0.8338, 0.8254, 0.8175, 0.8085, 0.8013, 0.7954, 0.7924, 0.7923, 0.7923, 0.7923, 0, 0,
		1, 1, 0.9958, 0.9754, 0.9540, 0.9325, 0.9122, 0.8947, 0.8814, 0.8732, 0.8666, 0.8607, 0.8555, 0.8510, 0.8470, 0.8435, 0.8406, 0.8380, 0.8358, 0.8338, 0.8254, 0.8175, 0.8085, 0.8013, 0.7954, 0.7924, 0.7923, 0.7923, 0.7923, 0, 0,
		1, 1, 0.9958, 0.9754, 0.9540, 0.9325, 0.9122, 0.8947, 0.8814, 0.8732, 0.8666, 0.8607, 0.8555, 0.8510, 0.8470, 0.8435, 0.8406, 0.8380, 0.8358, 0.8338, 0.8254, 0.8175, 0.8085, 0.8013, 0.7954, 0.7924, 0.7923, 0.7923, 0.7923, 0, 0,
		1, 1, 0.9958, 0.9754, 0.9540, 0.9325, 0.9122, 0.8947, 0.8814, 0.8732, 0.8666, 0.8607, 0.8555, 0.8510, 0.8470, 0.8435, 0.8406, 0.8380, 0.8358, 0.8338, 0.8254, 0.8175, 0.8085, 0.8013, 0.7954, 0.7924, 0.7923, 0.7923, 0.7923, 0, 0};

	sint16_t kPf, tabsize, dim=31;
	float64_t tabp[1984];

	/* Select the right table for the given fixed failure rate*/
	kPf = (sint32_t)(Pf * 1000);

	if (kPf==1)
	{
		memcpy(tabp,&table1[0],sizeof(table1));
		tabsize=64;
	}
	else if (kPf==10)
	{
		memcpy(tabp,&table10[0],sizeof(table10));
		tabsize=41;
	}
	else
	{
		//exit(0);/* errmsg(rtk,"FFRT Pf_fix not valid (Pf=%f)\n",Pf);  */
		return 0.0;
	}

	/* Make sure n is within range of table */
	if  (n < 1)
	{
		//exit(0);
		return 0.0;
	}

	if ( n >tabsize-1)
	{
		n=tabsize-1;
	}

	/* Use linear interpolation to find the treshhold value for the given PfILS*/
	return interp1q(tabp,tabp+n*dim ,dim,PfILS);
}

/*
calculate the cdf of normal distribution. regulate it to a proper file later.
Yanqing
input: X
output: P(x<X)
*/
static float64_t cnd_manual(float64_t x)
{
	float64_t L, K, w ;
	/* constants */
	float64_t const a1 = 0.31938153, a2 = -0.356563782, a3 = 1.781477937;
	float64_t const a4 = -1.821255978, a5 = 1.330274429;

	L = fabs(x);
	K = 1.0 / (1.0 + 0.2316419 * L);
	w = 1.0 - 1.0 / sqrt(2 * PI) * exp(-L *L / 2) * (a1 * K + a2 * K *K + a3 * pow(K,3) + a4 * pow(K,4) + a5 * pow(K,5));

	if (x < 0 )
	{
		w= 1.0 - w;
	}
	return w;
}

/*Calculate the bootstrapping success rate*/
static float64_t successrate(sint32_t k, sint32_t nb, float64_t D[])
{
	sint32_t i;
	float64_t t, Ps=1.0;

	for (i = k; i<nb; i++) 
	{
		t=cnd_manual(0.5/sqrt(D[i]));
		t=t*2-1;
		Ps*=t;
	}

	return Ps;
}

static float64_t cpmufit(float64_t Pftol, float64_t PfILS, sint32_t n)
{                     /*Pf_tol=0.01				  n	q1	      q2	q3 */
	static float64_t coeff01[198]=
	{
		0.0916,	-0.5801,	-0.285,
		0.1576,	-0.4633,	-0.3145,
		0.2164,	-0.3864,	-0.2878,
		0.3364,	-0.2968,	-0.3335,
		0.4401,	-0.2435,	-0.3686,
		0.3794,	-0.2521,	-0.2291,
		0.2904,	-0.2793,	-0.073 ,
		0.2874,	-0.2702,	-0.0146,
		0.1797,	-0.3314,	0.1593 ,
		0.1569,	-0.3439,	0.229  ,
		0.131 ,	-0.3615,	0.2998 ,
		0.0793,	-0.4428,	0.3928 ,
		0.0839,	-0.4222,	0.4166 ,
		0.0721,	-0.4411,	0.4563 ,
		0.07  ,	-0.4381,	0.4825 ,
		0.0664,	-0.4378,	0.5096 ,
		0.0645,	-0.4339,	0.5321 ,
		0.0674,	-0.4175,	0.5449 ,
		0.0683,	-0.4074,	0.5598 ,
		0.0647,	-0.409 ,	0.5783 ,
		0.0659,	-0.398 ,	0.5912 ,
		0.0661,	-0.391 ,	0.6039 ,
		0.0514,	-0.4286,	0.6342 ,
		0.0519,	-0.4202,	0.6435 ,
		0.0529,	-0.4098,	0.6531 ,
		0.0425,	-0.4442,	0.6762 ,
		0.0381,	-0.4575,	0.6916 ,
		0.0458,	-0.4183,	0.6885 ,
		0.0386,	-0.4443,	0.7059 ,
		0.0387,	-0.438 ,	0.7124 ,
		0.0385,	-0.4329,	0.7204 ,
		0.0384,	-0.4287,	0.7267 ,
		0.0393,	-0.4191,	0.7318 ,
		0.036 ,	-0.43  ,	0.7419 ,
		0.0392,	-0.4103,	0.7426 ,
		0.0345,	-0.4277,	0.7549 ,
		0.0323,	-0.4356,	0.7627 ,
		0.03  ,	-0.4443,	0.7704 ,
		0.0286,	-0.4493,	0.7759 ,
		0.0264,	-0.4594,	0.7842 ,
		0.0245,	-0.4695,	0.7904 ,
		0.0267,	-0.4501,	0.7905 ,
		0.0254,	-0.4545,	0.7966 ,
		0.0249,	-0.455 ,	0.8004 ,
		0.0249,	-0.4505,	0.8036 ,
		0.0269,	-0.4332,	0.8037 ,
		0.0237,	-0.4527,	0.8119 ,
		0.025 ,	-0.439 ,	0.8129 ,
		0.0255,	-0.4322,	0.8148 ,
		0.0259,	-0.4265,	0.8167 ,
		0.0231,	-0.4418,	0.824  ,
		0.0217,	-0.4504,	0.828  ,
		0.022 ,	-0.4457,	0.8305 ,
		0.0253,	-0.418 ,	0.8279 ,
		0.0211,	-0.4461,	0.8367 ,
		0.0193,	-0.4585,	0.8414 ,
		0.0166,	-0.485 ,	0.8472 ,
		0.0243,	-0.412 ,	0.8373 ,
		0.0179,	-0.4638,	0.8492 ,
		0.0205,	-0.436 ,	0.8478 ,
		0.0195,	-0.4434,	0.8505 ,
		0.0145,	-0.4951,	0.8605 ,
		0.0166,	-0.4634,	0.8581 ,
		0.0149,	-0.4873,	0.8628 ,
		0.0071,	-0.6131,	0.8773 ,
		0.0228,	-0.4002,	0.8536 ,
	};
	static float64_t coeff001[198]=
	{
		0.0549,	-0.4626,	-0.1968,
		0.0507,	-0.4739,	-0.145 ,
		0.0838,	-0.396 ,	-0.1556,
		0.1343,	-0.3225,	-0.1755,
		0.1946,	-0.2672,	-0.198 ,
		0.1876,	-0.2651,	-0.1429,
		0.1645,	-0.275 ,	-0.0755,
		0.1751,	-0.2605,	-0.0404,
		0.1229,	-0.3011,	0.0634 ,
		0.1133,	-0.3065,	0.1151 ,
		0.0938,	-0.3238,	0.1795 ,
		0.0636,	-0.3737,	0.2505 ,
		0.063 ,	-0.367 ,	0.2833 ,
		0.0522,	-0.3879,	0.3263 ,
		0.0512,	-0.3843,	0.3543 ,
		0.0498,	-0.3824,	0.3789 ,
		0.0483,	-0.3801,	0.4054 ,
		0.0489,	-0.3726,	0.4257 ,
		0.0492,	-0.3659,	0.445  ,
		0.0454,	-0.3699,	0.469  ,
		0.0443,	-0.3689,	0.488  ,
		0.0419,	-0.3721,	0.5072 ,
		0.0347,	-0.3933,	0.5322 ,
		0.0321,	-0.3999,	0.55   ,
		0.0318,	-0.3958,	0.5613 ,
		0.0273,	-0.4144,	0.5805 ,
		0.0261,	-0.4147,	0.5928 ,
		0.0242,	-0.4219,	0.6072 ,
		0.0226,	-0.4288,	0.6193 ,
		0.0208,	-0.4348,	0.6309 ,
		0.0172,	-0.4602,	0.6431 ,
		0.0189,	-0.4421,	0.6524 ,
		0.0212,	-0.4206,	0.6574 ,
		0.0197,	-0.4278,	0.6673 ,
		0.0206,	-0.4178,	0.6716 ,
		0.0174,	-0.4399,	0.6852 ,
		0.0182,	-0.4294,	0.6901 ,
		0.0161,	-0.4431,	0.7004 ,
		0.0132,	-0.4681,	0.7071 ,
		0.0137,	-0.4613,	0.7155 ,
		0.0117,	-0.4808,	0.7232 ,
		0.0118,	-0.4736,	0.7286 ,
		0.0103,	-0.4912,	0.7351 ,
		0.0111,	-0.4773,	0.7402 ,
		0.0095,	-0.4982,	0.7474 ,
		0.0095,	-0.4969,	0.7525 ,
		0.0085,	-0.5058,	0.7578 ,
		0.0098,	-0.4837,	0.7602 ,
		0.0105,	-0.4706,	0.7633 ,
		0.0108,	-0.4651,	0.7673 ,
		0.0072,	-0.521 ,	0.7757 ,
		0.0079,	-0.5051,	0.7767 ,
		0.0082,	-0.4956,	0.7819 ,
		0.0094,	-0.4744,	0.784  ,
		0.0077,	-0.5017,	0.7885 ,
		0.0056,	-0.5433,	0.7956 ,
		0.0057,	-0.54  ,	0.7998 ,
		0.0086,	-0.4742,	0.7975 ,
		0.007 ,	-0.4977,	0.7998 ,
		0.0085,	-0.4741,	0.8039 ,
		0.0107,	-0.4327,	0.8016 ,
		0.0058,	-0.5173,	0.8121 ,
		0.005 ,	-0.5369,	0.8181 ,
		0.0081,	-0.4521,	0.8137 ,
		0.0015,	-0.7293,	0.8205 ,
		0.0016,	-0.7571,	0.8317 ,
	};

	sint32_t coefflen = 3;
	float64_t q1=0, q2=0, q3=0;
	float64_t mu=0;

	if  (n < 1)
	{
		//exit(0);
		return 0.0;
	}
	if ( n >66)
	{
		n=66;
	}

	if (Pftol==0.01) 
	{
		q1=coeff01[coefflen*(n-1)];
		q2=coeff01[coefflen*(n-1)+1];
		q3=coeff01[coefflen*(n-1)+2];
	}
	else  { /* if (Pftol==0.001)   */
		q1=coeff001[coefflen*(n-1)];
		q2=coeff001[coefflen*(n-1)+1];
		q3=coeff001[coefflen*(n-1)+2];
	}

	if (PfILS>=0.2)
	{
		mu=0;
	}
	else if (PfILS<=Pftol)
	{
		mu=1;
	}
	else
	{
		mu=q1*pow(PfILS,q2)+q3;
	}

	if (mu>1)
	{
		mu=1;
	}
	else if (mu<0)
	{
		mu=0;
	}
	else
	{
		mu=mu;
	}

	return mu>0.0001?mu:0.0001;

}

/*compute the fix rate */
float64_t cpPfix1fit(float64_t Pftol, float64_t PfILS, sint32_t n)
{
	float64_t q4_pf001=0.3811, q4_pf01=0.5035;

	static float64_t coeffpfix001[198]=   //pf_tol=0.001
	{   
		0.0229,	0.0584,	-0.34,  
		0.0012,	-0.0065,0.0013,
		0.0016,	0.0058,	0.0016,
		0.0023,	0.0216,	0.0022,
		0.0029,	0.0275,	0.0028,
		0.0028,	0.028 ,	0.0027,
		0.0025,	0.0255,	0.0024,
		0.0026,	0.0252,	0.0025,
		0.0024,	0.0272,	0.0022,
		0.0023,	0.0263,	0.0022,
		0.0025,	0.0321,	0.0023,
		0.0014,	0.0076,	0.0014,
		0.0016,	0.0127,	0.0015,
		0.0013,	0.0061,	0.0013,
		0.0014,	0.0068,	0.0014,
		0.0017,	0.0169,	0.0016,
		0.0019,	0.0195,	0.0018,
		0.0025,	0.0328,	0.0023,
		0.0026,	0.0304,	0.0024,
		0.0029,	0.0401,	0.0027,
		0.0032,	0.04  ,	0.003 ,
		0.0035,	0.0504,	0.0033,
		0.0036,	0.0557,	0.0032,
		0.0037,	0.0529,	0.0035,
		0.004 ,	0.0588,	0.0037,
		0.0039,	0.0635,	0.0036,
		0.0038,	0.059 ,	0.0035,
		0.0037,	0.0488,	0.0035,
		0.0037,	0.0528,	0.0034,
		0.0039,	0.0484,	0.0036,
		0.0035,	0.0363,	0.0034,
		0.004 ,	0.0452,	0.0037,
		0.0044,	0.0509,	0.0041,
		0.0049,	0.0629,	0.0046,
		0.0045,	0.0459,	0.0043,
		0.0053,	0.0753,	0.0049,
		0.0056,	0.0787,	0.0052,
		0.0062,	0.098 ,	0.0057,
		0.0055,	0.0763,	0.0052,
		0.0056,	0.0817,	0.0052,
		0.005 ,	0.071 ,	0.0046,
		0.0045,	0.0489,	0.0043,
		0.0045,	0.0493,	0.0043,
		0.0042,	0.0426,	0.004 ,
		0.004 ,	0.0395,	0.0038,
		0.0039,	0.0312,	0.0038,
		0.0039,	0.0328,	0.0038,
		0.0042,	0.0413,	0.0041,
		0.0038,	0.0299,	0.0037,
		0.004 ,	0.0293,	0.0039,
		0.0041,	0.0358,	0.0039,
		0.0039,	0.0306,	0.0037,
		0.0037,	0.0228,	0.0036,
		0.0042,	0.0296,	0.0041,
		0.0043,	0.0385,	0.0041,
		0.0034,	0.0227,	0.0034,
		0.003 ,	0.0143,	0.003 ,
		0.0034,	0.0176,	0.0033,
		0.0037,	0.0216,	0.0037,
		0.0038,	0.0271,	0.0037,
		0.0035,	0.0215,	0.0034,
		0.0031,	0.0155,	0.003 ,
		0.0024,	0.0033,	0.0024,
		0.0028,	0.008 ,	0.0028,
		0.0029,	0.003 ,	0.0029,
		0.004 ,	0.0266,	0.004
	};

	static float64_t coeffpfix01[198]=
	{
		0.0225,	0.0242,	-0.3189,
		0.0081,	-0.0139,0.0082,
		0.0132,	0.026 ,	0.0127,
		0.0153,	0.0252,	0.0148,
		0.0176,	0.0337,	0.017 ,
		0.0192,	0.0482,	0.0183,
		0.0176,	0.0407,	0.0169,
		0.0177,	0.0384,	0.0171,
		0.0186,	0.0537,	0.0176,
		0.0196,	0.063 ,	0.0184,
		0.0205,	0.0704,	0.0192,
		0.0163,	0.0644,	0.0149,
		0.0139,	0.0331,	0.0132,
		0.0116,	0.0203,	0.0111,
		0.0121,	0.0229,	0.0115,
		0.0136,	0.0342,	0.0128,
		0.0164,	0.0541,	0.0153,
		0.0164,	0.0443,	0.0155,
		0.0163,	0.0413,	0.0154,
		0.0158,	0.0395,	0.0149,
		0.0193,	0.0579,	0.0183,
		0.021 ,	0.0686,	0.0198,
		0.0218,	0.0906,	0.02  ,
		0.018 ,	0.0549,	0.0168,
		0.0204,	0.0574,	0.0194,
		0.0228,	0.0906,	0.0211,
		0.0218,	0.0833,	0.0202,
		0.0198,	0.0535,	0.0189,
		0.023 ,	0.0902,	0.0213,
		0.0207,	0.0668,	0.0195,
		0.0206,	0.0521,	0.0197,
		0.0191,	0.0417,	0.0184,
		0.0227,	0.0634,	0.0217,
		0.0235,	0.0717,	0.0223,
		0.0243,	0.0709,	0.0231,
		0.0252,	0.0803,	0.0239,
		0.027 ,	0.0964,	0.0253,
		0.0273,	0.1016,	0.0255,
		0.0223,	0.0605,	0.0213,
		0.0252,	0.0812,	0.0239,
		0.0261,	0.1038,	0.0242,
		0.0216,	0.0604,	0.0205,
		0.0218,	0.056 ,	0.0209,
		0.021 ,	0.0542,	0.0201,
		0.0203,	0.0476,	0.0195,
		0.0203,	0.0423,	0.0196,
		0.0194,	0.0352,	0.0188,
		0.0206,	0.0412,	0.02  ,
		0.0229,	0.0567,	0.022 ,
		0.0238,	0.0605,	0.0228,
		0.0175,	0.021 ,	0.0172,
		0.0207,	0.0432,	0.0201,
		0.0193,	0.0281,	0.0189,
		0.021 ,	0.0358,	0.0205,
		0.0213,	0.0426,	0.0206,
		0.0164,	0.0137,	0.0162,
		0.016 ,	0.0114,	0.0159,
		0.0191,	0.0316,	0.0187,
		0.0165,	0.0099,	0.0164,
		0.0231,	0.0528,	0.0223,
		0.0224,	0.0516,	0.0216,
		0.0172,	0.0197,	0.017 ,
		0.0151,	0.0094,	0.015 ,
		0.0153,	0.0065,	0.0153,
		0.0106,	-0.0266,0.011,
		0.0148,	-0.0067,0.0149
	};

	sint32_t coefflen = 3;
	float64_t q1=0, q2=0, q3=0, q4=0;
	float64_t Pfix=0;

	if  (n < 1)
	{
		//exit(0);
		return 0.0;
	}
	if ( n >66)
	{
		n=66;
	}
	if (Pftol==0.01) 
	{
		q1=coeffpfix01[coefflen*(n-1)];
		q2=coeffpfix01[coefflen*(n-1)+1];
		q3=coeffpfix01[coefflen*(n-1)+2];
		q4=q4_pf01;
	}
	else  /* if (Pftol==0.001)   */
	{ 
		q1=coeffpfix001[coefflen*(n-1)];
		q2=coeffpfix001[coefflen*(n-1)+1];
		q3=coeffpfix001[coefflen*(n-1)+2];
		q4=q4_pf001;
	}

	if (PfILS>=0.2)
	{
		Pfix=0;
	}
	else if (PfILS<=Pftol)
	{
		Pfix=1;
	}
	else if (n==1)
	{
		Pfix=q1*PfILS*PfILS*PfILS+q2*PfILS*PfILS+q3*PfILS+q4;
	}
	else
	{
		Pfix=q1/(PfILS*PfILS+q2*PfILS+q3);
	}

	if (Pfix>1)
	{
		Pfix=1;
	}

	return Pfix;
}

/******************************************************************************
* 函数名称：lambda_ffrt()
* 功能描述：固定失败率的模糊度解算
* 输入参数：int n - 浮点解参数个数
*           int m - 固定解组合的个数
*           double a[] - 浮点解参数
*           const double Q[] - 浮点解协因数矩阵
*           double Pf - FFRT计算的失败率
* 输出参数：double F[] - 固定解矩阵
*           double s[] - 固定解残差
*           double mu[] - FFRT计算的ratio阈值
* 返 回 值: 解算标识
* 其它说明： 
* 修改日期:          版本号      修改人:       修改内容:
* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
******************************************************************************/
/* lambda/mlambda integer least-square estimation ------------------------------
* integer least-square estimation. reduction is performed by lambda (ref.[1]),
* and search by mlambda (ref.[2]).
* args   : int    n      I  number of float parameters
*          int    m      I  number of fixed solutions
*          double *a     I  float parameters (n x 1)
*          double *Q     I  covariance matrix of float parameters (n x n)
*          double *F     O  fixed solutions (n x m)
*          double *s     O  sum of squared residulas of fixed solutions (1 x m)
* return : status (0:ok,other:error)
* notes  : matrix stored by column-major order (fortran convension)
*-----------------------------------------------------------------------------*/
sint8_t LambdaFFRT(uint16_t n, uint16_t m, const float64_t a[], const float64_t Q[], float64_t Pf,float64_t F[], float64_t s[], float64_t mu[])
{
	uint8_t info;
	float64_t L[MAXDIM*MAXDIM],D[MAXDIM];
	float64_t Z[MAXDIM*MAXDIM],z[MAXDIM];
	float64_t E[MAXDIM*AMBSOLNUM];
	float64_t Zt[MAXDIM*MAXDIM], iZ[MAXDIM*MAXDIM], iZt[MAXDIM*MAXDIM];
	float64_t ps=0;

	if (n<=0||m<=0) return -1;

	memset(&L[0],0,MAXDIM*MAXDIM*sizeof(float64_t));
	memset(&z[0],0,MAXDIM*sizeof(float64_t));
	memset(&Z[0],0,MAXDIM*MAXDIM*sizeof(float64_t));
	Eye(Z,n);

	/* LD factorization */
	if (!(info=LD(n,Q,L,D))) 
	{
		/* lambda reduction */
		reduction(n,L,D,Z); //最小二乘模糊度降相关法
		ps=successrate(0,n,D); //根据BOOTSTRAP法计算成功率

		//matmul("TN",n,1,n,1.0,Z,a,0.0,z); /* z=Z'*a */
		TransMat(Z, n, n,Zt);
		MulMat(Zt,a,n,n,1,z);

		//在固定失败率1%的情况下，根据bootstrap计算的成功率查表得Ratio阈值
		if ((fabs(invratio(Pf,1-ps,n))<EPSILON)&&(ps<1))
        {
            mu[0]=10000.0;
        } 
        else
        {
			mu[0]=ps<1?1/invratio(Pf,1-ps,n):1; //Sandra 
        }
		//mu[1]=1/cpmufit(Pf,1-ps,n); //houyq

		/* mlambda search */
		if (!(info=search(n,m,L,D,z,E,s))) //LAMBDA搜索模糊度固定值
		{
			//info=solve("T",Z,E,n,m,F); /* F=Z'\E */ 

			if (!(info = InvMat(Z, n, iZ)))
			{
				TransMat(iZ, n, n, iZt);
				MulMat(iZt, E, n, n, m, F);
				mu[1] = s[1] / s[0];
			}
		}
	}
	return info;
}
